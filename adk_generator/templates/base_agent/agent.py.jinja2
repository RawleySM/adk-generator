"""{{ description }}"""

{% if agent_type == "LlmAgent" %}
from google.adk.agents import LlmAgent
{% elif agent_type == "SequentialAgent" %}
from google.adk.agents import LlmAgent, SequentialAgent
{% elif agent_type == "LoopAgent" %}
from google.adk.agents import LlmAgent, LoopAgent
{% elif agent_type == "ParallelAgent" %}
from google.adk.agents import LlmAgent, ParallelAgent
{% elif agent_type == "Nested" %}
from google.adk.agents import LlmAgent, SequentialAgent, LoopAgent, ParallelAgent
{% endif %}
{% if has_tools %}
from .tools import all_tools
{% endif %}
{% if has_callbacks %}
from .callbacks import (
    before_agent_callback,
    after_agent_callback,
    {% if callbacks.before_model %}before_model_callback,{% endif %}
    {% if callbacks.after_model %}after_model_callback,{% endif %}
    {% if callbacks.before_tool %}before_tool_callback,{% endif %}
    {% if callbacks.after_tool %}after_tool_callback,{% endif %}
)
{% endif %}

{% if agent_type == "LlmAgent" %}
AGENT_INSTRUCTION = """
{{ instruction }}
"""

root_agent = LlmAgent(
    name="{{ agent_name }}",
    model="{{ model }}",
    description="{{ description }}",
    instruction=AGENT_INSTRUCTION,
    {% if has_tools %}
    tools=all_tools,
    {% else %}
    tools=[],
    {% endif %}
    {% if has_callbacks %}
    before_agent_callback=before_agent_callback,
    after_agent_callback=after_agent_callback,
    {% if callbacks.before_model %}before_model_callback=before_model_callback,{% endif %}
    {% if callbacks.after_model %}after_model_callback=after_model_callback,{% endif %}
    {% if callbacks.before_tool %}before_tool_callback=before_tool_callback,{% endif %}
    {% if callbacks.after_tool %}after_tool_callback=after_tool_callback,{% endif %}
    {% endif %}
)
{% else %}
# Define sub-agents
{% for agent in sub_agents %}
{{ agent.name }}_instruction = """
{{ agent.instruction }}
"""

{{ agent.name }} = LlmAgent(
    name="{{ agent.name }}",
    model="{{ agent.model }}",
    instruction={{ agent.name }}_instruction,
    description="{{ agent.description }}",
    {% if agent.tools %}
    tools={{ agent.tools }},
    {% endif %}
    {% if agent.output_key %}
    output_key="{{ agent.output_key }}",
    {% endif %}
)

{% endfor %}

{% if workflow_agents %}
# Define nested workflow agents
{% for workflow in workflow_agents %}
{{ workflow.name }} = {{ workflow.type }}(
    name="{{ workflow.name }}",
    sub_agents=[
        {% for sub_agent in workflow.sub_agents %}
        {{ sub_agent }},
        {% endfor %}
    ],
    {% if workflow.max_iterations %}
    max_iterations={{ workflow.max_iterations }},
    {% endif %}
    description="{{ workflow.description }}"
)

{% endfor %}
{% endif %}

# Create root workflow agent
root_agent = {{ agent_type }}(
    name="{{ agent_name }}",
    sub_agents=[
        {% for agent in root_sub_agents %}
        {{ agent }},
        {% endfor %}
    ],
    {% if max_iterations %}
    max_iterations={{ max_iterations }},
    {% endif %}
    description="{{ description }}"
)
{% endif %}
